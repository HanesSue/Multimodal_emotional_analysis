# 多模态情感分析

## 项目简介

这是一个课程项目，用于多模态情感分析。项目基于PyTorch框架。项目包括以下部分：

- 数据集：包含文本、音频和视频数据，用于训练和测试模型。
- 模型：TODO
- 训练和测试：TODO

项目构建的多模态情感分析模型包括文本情感分析器，语音情感分析器，视频情感分析器。

## 文本情感分析器

文本情感分析器用于中文文本情感强度预测，目标是从一段自然语言文本中预测其情绪倾向，输出一个连续值，范围在 [-1, 1] 之间，表示情绪的强弱和方向（如 -1：极端负面，1：极端正面）。

文本情感分析器采用BertTextCNN架构，其中Bert层采用预训练的bert-base-chinese模型：

原始文本  
⬇  
**[BERT tokenizer]**  
⬇  
`input_ids` + `attention_mask`  
⬇  
**[BERT encoder]**（抽取上下文语义特征）  
⬇  
`last_hidden_state` `(batch_size, seq_len, 768)`  
⬇  
**[TextCNN]**（提取局部模式）  
⬇  
拼接特征 + Dropout + Linear  
⬇  
回归输出（预测值 ∈ [-1, 1]）





### 离散化机制

在本模型中，虽然最终输出的是连续值（回归任务），但我们为了更好地解释模型预测、进行结果分类或可视化，会将这些连续值**离散化**到一组固定的标签值中。

---

#### 离散标签集合：

模型预设的离散标签如下：

[-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0]

这些值通常用于表示情感极性：从非常消极（-1.0）到非常积极（1.0），中间为中性（0.0）。

---

#### 离散化方法说明：

使用 NumPy 实现最小距离匹配，将任意实数预测值映射到上述标签集合中距离最近的一个：

```python
def discretize(self, value):
    values = np.array(self.DISCRETE_VALUES)
    return float(values[np.argmin(np.abs(values - value))])
```




